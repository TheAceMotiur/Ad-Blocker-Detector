<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Blocker Detector Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .status {
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.no-blocker {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.has-blocker {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>Ad Blocker Detector Test Page</h1>
    
    <div id="status" class="status">
        Testing... Please wait for detection to complete.
    </div>
    
    <h2>Detection Log</h2>
    <div id="log" class="log">
        Initializing detector...<br>
    </div>
    
    <h2>Instructions</h2>
    <ol>
        <li>First, test with <strong>no ad blocker</strong> - you should see "No Ad Blocker Detected"</li>
        <li>Then, enable an ad blocker (uBlock Origin, AdBlock, etc.) and refresh</li>
        <li>With ad blocker enabled, you should see the warning overlay</li>
    </ol>
    
    <h2>Test Elements</h2>
    <p>These elements are used to test if the detector is working correctly:</p>
    
    <!-- Test ad elements -->
    <div class="ad" style="width: 300px; height: 250px; border: 1px solid #ccc; padding: 10px; margin: 10px 0;">
        <p>Test Ad Element (class="ad")</p>
        <p>If ad blocker is active, this might be hidden.</p>
    </div>
    
    <div class="advertisement" style="width: 300px; height: 100px; border: 1px solid #ccc; padding: 10px; margin: 10px 0;">
        <p>Test Advertisement Element</p>
    </div>

    <script src="js/adblock-detector.js"></script>
    <script>
        // Capture console.log for our log display
        const originalLog = console.log;
        const logElement = document.getElementById('log');
        const statusElement = document.getElementById('status');
        
        function addToLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLog(args.join(' '));
        };
        
        // Initialize detector with test-friendly settings
        document.addEventListener('DOMContentLoaded', function() {
            addToLog('DOM loaded, initializing detector...');
            
            const detector = new AdBlockDetector({
                warningMessage: 'Ad blocker detected! This is a test - you can see the detection is working.',
                warningTitle: 'ðŸ§ª Test: Ad Blocker Detected',
                opacity: 0.9,
                blur: true,
                blurAmount: 3,
            });
            
            // Override showWarning to also update our status
            const originalShowWarning = detector.showWarning.bind(detector);
            detector.showWarning = function() {
                statusElement.className = 'status has-blocker';
                statusElement.textContent = 'ðŸš« Ad Blocker Detected!';
                addToLog('Ad blocker detection triggered - showing warning');
                originalShowWarning();
            };
            
            // Override hideWarning to also update our status
            const originalHideWarning = detector.hideWarning.bind(detector);
            detector.hideWarning = function() {
                statusElement.className = 'status no-blocker';
                statusElement.textContent = 'âœ… No Ad Blocker Detected';
                addToLog('No ad blocker detected - hiding warning');
                originalHideWarning();
            };
            
            detector.init().then(() => {
                addToLog('Detector initialized successfully');
            }).catch(error => {
                addToLog('Error initializing detector: ' + error.message);
            });
        });
    </script>
</body>
</html>
